----------------------------------------------------------------------------
MACCHESS Centering Project Instructions/Documentation for setting up software
---------------------------------------------------------------------------
Ismail Degani
id35@cornell.edu
Monday, August 4th 2003


--------------------------------
Step 1: Install Redhat7.1 (or higher version) Linux on your pc 
--------------------------------

After installation, check here: /lib/modules/2.4.2-2/kernel/drivers/ieee1394 
You should be able to see some files, such as 

ieee1394.o
ohci1394.o 
video1394.o 
raw1394.o.

If you can't find them, then your Redhat is not complete, you need to 
install a complete Redhat.

--------------------------------
Step 2: Hardware Installation
--------------------------------

Install the firewire PCI card on your desktop pc

--------------------------------
Step 3: Install libraw1394, libdc1394
--------------------------------

Go to these URLs: http://download.sourceforge.net/libraw1394/. 
		  http://download.sourceforge.net/libdc1394/. 

It is preferable to download the source and build it, (I use configure, 
make, make install) but here are directions for  getting it to work using 
RPM's under Redhat

Download both:

libraw1394-0.9.0-1.i386.rpm 
libraw1394-devel-0.9.0-1.i386.rpm.

Login as root, use following commands to install them:
rpm -Uvh libraw1394-0.9.0-1.i386.rpm
rpm -Uvh libraw1394-devel-0.9.0-1.i386.rpm

--------------------------------
Step 4: Create device files
--------------------------------


Check whether you have these two device files: 

/dev/raw1394
/dev/video1394 

If you don't have them, you need to create them using
following commands (login as root user):

mknod -m 666 /dev/raw1394 c 171 0
mknod -m 666 /dev/video1394 c 172 0

For a newer kernel like 2.4.17:
/dev/video1394 device numbers are different. You should use: 

mknod -m 666 /dev/video1394 c 172 16.

--------------------------------
Step 5: Add modules
--------------------------------

Run following five commands (login as root user):
/sbin/insmod ieee1394
/sbin/insmod raw1394
/sbin/insmod ohci1394 attempt_root=1
/sbin/insmod video1394
/sbin/lsmod

If there are  no error messages and you can see all modules being listed 
in the last command's result, then it means the modules from your redhat 
linux is ok, otherwise you'll need more tricky work, please then refer 
to http://linux1394.sourceforge.net.

--------------------------------
Step 6: Add the step5's scripts into the login process. 
--------------------------------

If the step 5 is ok, then you can add those scripts to the login process, 
so that each time you login in, the firewire support will be automatically 
set up for you. 

Login as root user, edit the file /etc/rc.d/rc.local 
append the five commands listed in step5 to the end of this file.

Notes:

--------------------------------
Error message: Coriander or MACCHESS Digital Streaming server
--------------------------------
Cannot open libdc1394_control.so.9: No such file or directory
--------------------------------
Solution:
--------------------------------
You need to update your libraries listing to include /usr/local/lib
Add this directory to the list in /etc/ld.so.conf

--------------------------------
Error message: Coriander
--------------------------------
Cannot connect to firewire camera as a normal user, but no problem when 
running as root
--------------------------------
Solution:
--------------------------------
Change the permissions of these devices:

/dev/raw1394 
/dev/video1394

Using the following command to give everyone read/write access:

chmod 666 /dev/raw1394
chmod 666 /dev/video1394

--------------------------------
Error Message:
--------------------------------

(dc1394_capture.c) unable to open video1394 device /dev/video1394
dc1394_capture.c: No such device

unable to setup camera- check line xxx of dc1394_multiview.c to make sure
that the video mode,framerate and format are supported

--------------------------------
Solution:
--------------------------------

If you already have a video1394 device, delete it.

rm /dev/video1394 (You need to be root)

Then

mkdir /dev/video1394
mknod -m 666 /dev/video1394/0 c 171 16 
mknod -m 666 /dev/video1394/1 c 171 17 

I have no idea why this works, but it does...

------------------------------------------


If you still have problems when , try running /sbin/ldconfig as root
